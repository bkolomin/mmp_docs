Парсер это внешняя обработка, которая выкачивает данные из других источников и передаёт их в модуль загрузки прайсов.

Например, можно сделать обработку (парсер) который зайдёт на сайт поставщика и соберёт названия, цены и остатки всех его товаров.

Все сайты разные, поэтому универсальную обработку сбора данных с сайтов сделать очень сложно. Поэтому под каждый сайт делается небольшая специализированная обработками, заточенная только под него.

Если вам нужно сделать такую обработку (парсер) можете обратиться к нам или к другим программистам 1с. Внешним программистам понадобится глава ниже "Формат внешней обработки парсера". Передайте её им.

По кнопке "Парсер / Загрузить товары" результат работы парсера будет записан в файл, указанный на закладке "Файл на диске". Чтобы загрузить этот файл, нажмите кнопку "Загрузить файл".

При первоначальной настройке нажимайте кнопку "Парсер / Тестовая загрузка (200 товаров)". Загрузка полного сайта может занять несколько десятков минут. Тестовая загрузка выполнится гораздо быстрее.

В автоматическом режиме сначала проверяется наличие файла на диске, если он существует - прайс загружается из него, если нет — запускается парсер (если стоит флаг "Парсер / Автозагрузка") . Нужно поставить флаг "Удалить файл после загрузки" чтобы файл удалился.

## Подключение парсера
На закладке "Файл / Парсер" нажмите кнопку "Загрузить из файла...". Выберите файл обработки. Нажмите записать.

Автоматически установится:

-   Тип файла - "Внутренний формат 1с"
-   Имя и каталог на закладке "Файл на диске"

## Формат внешней обработки парсера

Парсер это внешняя обработка (epf-файл).

Обработка должна содержать экспортную функцию модуля "Функция ПолучитьСписокТоваров(КоличествоЗагружаемыхТоваров) Экспорт" которая возвращает структуру с результатом загрузки.

Возвращаемое значение:

-   Возвращается структура с полем "СписокТоваров", содержащим таблицу значений с загруженными данными. Названия колонок в таблице могут быть любыми (пользователь сам выберет нужные при настройке загрузки прайсов из файла)
-   При ошибке:
    -   Можно вернуть "Неопределено" или пустую структуру
    -   Желательно, но не обязательно заполнить поля "Ошибка", "ТекстОшибки".

Обязательный параметр "КоличествоЗагружаемыхТоваров":

-   там передаётся число с максимальным количество товаров, которое нужно загрузить. Или 0, если не нужно ограничивать количество загружаемых товаров
-   нужен для тестового запуска парсера пользователем (обычно 200 товаров)
-   без него весь сайт может обходится долго и пользователю придётся долго ждать, перед тем как приступить к настройке загрузки передаваемой из парсера таблицы.

Пример функции:

```
Функция		ПолучитьСписокТоваров(КоличествоЗагружаемыхТоваров)	Экспорт
	
	ТЗ	=	Новый	ТаблицаЗначений;
	ТЗ.Колонки.Добавить("Артикул");
	ТЗ.Колонки.Добавить("Наименование");
	ТЗ.Колонки.Добавить("Цена");
	ТЗ.Колонки.Добавить("Остаток");

	ПараметрыЗагрузки	=	Новый	Структура;
	ПараметрыЗагрузки.Вставить("ТЗ",				ТЗ);
	ПараметрыЗагрузки.Вставить("КоличествоЗагружаемыхТоваров",	КоличествоЗагружаемыхТоваров);
	
	СобратьТоварыССайта(ПараметрыЗагрузки);
	
	
	Результат	=	Новый	Структура;
	Результат.Вставить("СписокТоваров",	ПараметрыЗагрузки.ТЗ);
	Результат.Вставить("Ошибка",		ПараметрыЗагрузки.Ошибка);
	Результат.Вставить("ТекстОшибки",	ПараметрыЗагрузки.ТекстОшибки);
	
	Возврат	Результат;

КонецФункции
```